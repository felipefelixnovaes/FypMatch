---
description: 
globs: 
alwaysApply: true
---
// Android Jetpack Compose .cursorrules

// Flexibility Notice

// Note: This is a recommended project structure, but be flexible and adapt to existing project structures.
// Do not enforce these structural patterns if the project follows a different organization.
// Focus on maintaining consistency with the existing project architecture while applying Jetpack Compose best practices.

// Project Architecture and Best Practices

const androidJetpackComposeBestPractices = [
    "Adapt to existing project architecture while maintaining clean code principles",
    "Follow Material Design 3 guidelines and components",
    "Implement clean architecture with domain, data, and presentation layers",
    "Use Kotlin coroutines and Flow for asynchronous operations",
    "Implement dependency injection using Hilt",
    "Follow unidirectional data flow with ViewModel and UI State",
    "Use Compose navigation for screen management",
    "Implement proper state hoisting and composition",
];

// Folder Structure

// Note: This is a reference structure. Adapt to the project's existing organization

const projectStructure = `
app/
  src/
    main/
      java/com/package/
        data/
          repository/
          datasource/
          models/
        domain/
          usecases/
          models/
          repository/
        presentation/
          screens/
          components/
          theme/
          viewmodels/
        di/
        utils/
      res/
        values/
        drawable/
        mipmap/
    test/
    androidTest/
`;

// Compose UI Guidelines

const composeGuidelines = `
1. Use remember and derivedStateOf appropriately
2. Implement proper recomposition optimization
3. Use proper Compose modifiers ordering
4. Follow composable function naming conventions
5. Implement proper preview annotations
6. Use proper state management with MutableState
7. Implement proper error handling and loading states
8. Use proper theming with MaterialTheme
9. Follow accessibility guidelines
10. Implement proper animation patterns
`;

// Testing Guidelines

const testingGuidelines = `
1. Write unit tests for ViewModels and UseCases
2. Implement UI tests using Compose testing framework
3. Use fake repositories for testing
4. Implement proper test coverage
5. Use proper testing coroutine dispatchers
`;

// Performance Guidelines

const performanceGuidelines = `
1. Minimize recomposition using proper keys
2. Use proper lazy loading with LazyColumn and LazyRow
3. Implement efficient image loading
4. Use proper state management to prevent unnecessary updates
5. Follow proper lifecycle awareness
6. Implement proper memory management
7. Use proper background processing
`; {
  "projectStructure": """
  app/src/main/java/com/ideiassertiva/FypMatch/
  â”œâ”€â”€ data/model/              # DTOs especÃ­ficos da API ou Firebase
  â”œâ”€â”€ domain/model/            # Modelos puros usados em UseCases e UI
  â”œâ”€â”€ data/repository/         # Camada de dados (Firebase, APIs)
  â”‚   â”œâ”€â”€ AuthRepository.kt
  â”‚   â”œâ”€â”€ UserRepository.kt
  â”‚   â”œâ”€â”€ LocationRepository.kt
  â”‚   â”œâ”€â”€ ChatRepository.kt
  â”‚   â”œâ”€â”€ DiscoveryRepository.kt
  â”‚   â”œâ”€â”€ PhotoRepository.kt
  â”‚   â””â”€â”€ AICounselorRepository.kt
  â”œâ”€â”€ ui/screens/
  â”‚   â”œâ”€â”€ discovery/           # Tela de discovery
  â”‚   â”œâ”€â”€ auth/                # Tela de login e cadastro
  â”‚   â”œâ”€â”€ chat/
  â”‚   â”œâ”€â”€ profile/
  â”œâ”€â”€ ui/navigation/FypMatchNavigation.kt
  â”œâ”€â”€ ui/theme/Theme.kt, Color.kt, Type.kt
  â”œâ”€â”€ ui/viewmodel/LoginViewModel.kt, DiscoveryViewModel.kt
  â”œâ”€â”€ di/AppModule.kt
  â””â”€â”€ util/AnalyticsManager.kt, LocationManager.kt, AdMobConfig.kt
  """,

  "architecture": [
    "Seguir arquitetura MVVM com Repository Pattern",
    "Usar Hilt para Dependency Injection em todos os ViewModels",
    "Implementar StateFlow para gerenciamento de estado reativo",
    "Usar Firebase Firestore para dados estruturados",
    "Usar Firebase Realtime Database para chat em tempo real",
    "Implementar Clean Architecture com separaÃ§Ã£o clara de responsabilidades",
    "Usar Mappers entre DTOs, Models e UIModels",
    "Evitar lÃ³gica de negÃ³cio em Repositories ou ViewModels",
    "Usar Result<T> para modelar operaÃ§Ãµes falhas com fallback",
    "Implementar AnalyticsManager em todas as aÃ§Ãµes-chave"
  ],

  "composeBestPractices": [
    "Usar @HiltViewModel em todos os ViewModels",
    "Implementar @Preview para todas as telas",
    "Usar collectAsStateWithLifecycle() para StateFlow",
    "Evitar recomposition com rememberUpdatedState em callbacks",
    "Usar derivedStateOf para lÃ³gica derivada na UI",
    "Usar Modifier.fillMaxSize() e Spacer() para espaÃ§amento",
    "Seguir padrÃ£o de nomenclatura: NomeScreen.kt, NomeViewModel.kt",
    "CircularProgressIndicator para loading",
    "MaterialTheme.colorScheme para cores",
    "Erro com try-catch e feedback amigÃ¡vel ao usuÃ¡rio"
  ],

  "firebasePatterns": [
    "Usar Firestore para perfis e preferÃªncias",
    "Realtime DB para status online e mensagens",
    "Storage para upload de fotos com fallback",
    "Estrutura clara: users/, profiles/, matches/, conversations/",
    "Sempre retornar Result<T> com try-catch",
    "Evitar listeners sem cancelamento",
    "Usar transaÃ§Ãµes para dados crÃ­ticos (ex: match)"
  ],

  "testing": [
    "Usar TestScope.runTest para testes de coroutines",
    "Mocks com MockK relaxed = true",
    "ComposeTestRule para UI tests",
    "Firebase Emulator para integraÃ§Ã£o",
    "Testar todos os estados: loading, success, error",
    "InstantTaskExecutorRule para LiveData/StateFlow",
    "Testar navegaÃ§Ã£o e conversÃ£o de estados"
  ],

  "security": [
    "AccessLevel enum para controle de acesso",
    "Firebase Security Rules configuradas",
    "ValidaÃ§Ã£o de permissÃ£o de GPS",
    "Rate limiting para endpoints sensÃ­veis",
    "Logout automÃ¡tico por inatividade",
    "Criptografar tokens/local storage",
    "OfuscaÃ§Ã£o de dados sensÃ­veis nos logs"
  ],

  "performance": [
    "PaginaÃ§Ã£o em discovery com lazy loading",
    "Cache local de perfis visualizados",
    "Imagens otimizadas e em vÃ¡rias resoluÃ§Ãµes",
    "remember(), rememberUpdatedState e composition condicional",
    "Debounce na busca de usuÃ¡rios",
    "Background processing para uploads",
    "Uso de Benchmarking Library e Systrace"
  ],

  "aiIntegration": [
    "Usar Gemini API para respostas e conselhos",
    "Rate limiting e controle de sessÃ£o",
    "Fallback se IA estiver indisponÃ­vel",
    "Sistema de crÃ©ditos por uso da IA",
    "Logs e analytics de uso de IA",
    "Prompts com contexto delimitado por tokens"
  ],

  "monetization": [
    "Google Billing para assinaturas",
    "AdMob com anÃºncios recompensados",
    "SubscriptionStatus enum para controle",
    "FunÃ§Ãµes premium com sistema de crÃ©ditos",
    "Analytics de conversÃ£o e funil",
    "A/B testing com Firebase Remote Config",
    "Recuperar compras antigas (restore purchases)"
  ],

  "style": [
    "PascalCase para classes, camelCase para variÃ¡veis, SNAKE_CASE para constantes",
    "ViewModel prefixado pela tela (ex: ChatViewModel)",
    "KDoc obrigatÃ³rio em classes pÃºblicas",
    "Mensagens de erro legÃ­veis e localizadas em portuguÃªs",
    "Nomes de variÃ¡veis claros (evitar 'data', 'temp')",
    "Sealed classes para representar estados e aÃ§Ãµes"
  ],

  "accessibility": [
    "contentDescription em imagens",
    "Contrast ratio ideal em todos os temas",
    "Keyboard navigation e screen reader support",
    "Focus management e navegaÃ§Ã£o acessÃ­vel",
    "Uso de semantics tags"
  ],

  "localization": [
    "strings.xml obrigatÃ³rio para todos os textos",
    "Formatos de data, hora e nÃºmero locais",
    "Suporte a pluralizaÃ§Ã£o e ordenaÃ§Ã£o regional",
    "RTL e mÃºltiplos idiomas preparados"
  ],

  "analytics": [
    "Tracking com AnalyticsManager para eventos-chave",
    "Crashlytics configurado com logs adicionais",
    "Funnel analysis com eventos customizados",
    "Monitoramento de performance com Firebase",
    "Tracking de propriedades do usuÃ¡rio (premium, onboarding, etc.)"
  ],

  "deployment": [
    "Variants debug/release com configs separadas",
    "Assinatura de app com key segura",
    "Controle de versÃ£o semÃ¢ntico (major.minor.patch)",
    "ProGuard ativado e configurado",
    "CI/CD com GitHub Actions e Firebase Distribution",
    "Notas de versÃ£o e validaÃ§Ã£o com Firebase Test Lab"
  ]
}// FypMatch Android Jetpack Compose .cursorrules
// Otimizado para o projeto FypMatch - App de namoro com IA

// ===== ESTRUTURA DO PROJETO FYPMATCH =====

const projectStructure = `
app/src/main/java/com/ideiassertiva/FypMatch/
â”œâ”€â”€ data/repository/          # Camada de dados (Firebase, APIs)
â”‚   â”œâ”€â”€ AuthRepository.kt     # AutenticaÃ§Ã£o (Google, Email, Phone)
â”‚   â”œâ”€â”€ UserRepository.kt     # GestÃ£o de usuÃ¡rios
â”‚   â”œâ”€â”€ LocationRepository.kt # GPS e proximidade
â”‚   â”œâ”€â”€ ChatRepository.kt     # Sistema de chat
â”‚   â”œâ”€â”€ DiscoveryRepository.kt # Swipe e matches
â”‚   â”œâ”€â”€ PhotoRepository.kt    # Upload de fotos
â”‚   â””â”€â”€ AICounselorRepository.kt # IA conselheira
â”œâ”€â”€ model/                    # Modelos de domÃ­nio
â”‚   â”œâ”€â”€ User.kt              # Modelo principal do usuÃ¡rio
â”‚   â”œâ”€â”€ Match.kt             # Modelo de matches
â”‚   â”œâ”€â”€ Message.kt           # Modelo de mensagens
â”‚   â””â”€â”€ AccessLevel.kt       # Controle de acesso
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ screens/             # Telas Compose
â”‚   â”‚   â”œâ”€â”€ WelcomeScreen.kt
â”‚   â”‚   â”œâ”€â”€ LoginScreen.kt
â”‚   â”‚   â”œâ”€â”€ DiscoveryScreen.kt
â”‚   â”‚   â”œâ”€â”€ ChatScreen.kt
â”‚   â”‚   â””â”€â”€ ProfileScreen.kt
â”‚   â”œâ”€â”€ navigation/          # Sistema de navegaÃ§Ã£o
â”‚   â”‚   â””â”€â”€ FypMatchNavigation.kt
â”‚   â”œâ”€â”€ theme/               # Tema Material Design 3
â”‚   â”‚   â”œâ”€â”€ Theme.kt
â”‚   â”‚   â”œâ”€â”€ Color.kt
â”‚   â”‚   â””â”€â”€ Type.kt
â”‚   â””â”€â”€ viewmodel/           # ViewModels com Hilt
â”‚       â”œâ”€â”€ LoginViewModel.kt
â”‚       â”œâ”€â”€ DiscoveryViewModel.kt
â”‚       â””â”€â”€ ProfileViewModel.kt
â”œâ”€â”€ di/                      # Dependency Injection (Hilt)
â”‚   â””â”€â”€ AppModule.kt
â””â”€â”€ util/                    # UtilitÃ¡rios
    â”œâ”€â”€ AnalyticsManager.kt
    â”œâ”€â”€ LocationManager.kt
    â””â”€â”€ AdMobConfig.kt
`;

// ===== ARQUITETURA E PADRÃ•ES FYPMATCH =====

const fypMatchArchitecture = [
    "Seguir arquitetura MVVM com Repository Pattern",
    "Usar Hilt para Dependency Injection em todos os ViewModels",
    "Implementar StateFlow para gerenciamento de estado reativo",
    "Usar Firebase Firestore para dados estruturados",
    "Usar Firebase Realtime Database para chat em tempo real",
    "Implementar Clean Architecture com separaÃ§Ã£o clara de responsabilidades",
    "Seguir padrÃ£o unidirectional data flow",
    "Usar Result<T> para operaÃ§Ãµes que podem falhar",
    "Implementar analytics com AnalyticsManager em todas as aÃ§Ãµes importantes"
];

// ===== GUIDELINES ESPECÃFICAS DO FYPMATCH =====

const fypMatchGuidelines = `
1. AUTENTICAÃ‡ÃƒO:
   - Sempre usar AuthRepository para operaÃ§Ãµes de login
   - Implementar Google Sign-In, Email e Phone Auth
   - Gerenciar estados com NavigationState enum
   - Usar AnalyticsManager para tracking de eventos

2. FIREBASE INTEGRATION:
   - Firestore para dados de perfil e preferÃªncias
   - Realtime Database para chat e status online
   - Firebase Storage para fotos (com fallback para URLs externas)
   - Implementar offline support com cache local

3. UI/UX PATTERNS:
   - Usar Material Design 3 com tema rosa/roxo personalizado
   - Implementar gradientes para telas premium
   - Seguir padrÃ£o de cards para exibiÃ§Ã£o de perfis
   - Usar emojis consistentemente na UI (ğŸ’•, ğŸ”, ğŸ“, etc.)

4. ESTADO E NAVEGAÃ‡ÃƒO:
   - Usar sealed classes para estados (LoginUiState, DiscoveryUiState)
   - Implementar navegaÃ§Ã£o com popUpTo para limpar stack
   - Gerenciar loading states em todos os ViewModels
   - Usar collectAsStateWithLifecycle() para observar estados

5. TESTING:
   - Implementar testes unitÃ¡rios para ViewModels
   - Usar MockK para mocking de repositories
   - Testar com coordenadas reais de SÃ£o Paulo
   - Implementar testes de UI com Compose Testing

6. PERFORMANCE:
   - Usar LazyColumn/LazyRow para listas
   - Implementar paginaÃ§Ã£o para discovery
   - Otimizar imagens com thumbnails
   - Usar remember() adequadamente para evitar recomposiÃ§Ãµes
`;

// ===== COMPOSE BEST PRACTICES FYPMATCH =====

const composeBestPractices = [
    "Usar @HiltViewModel em todos os ViewModels",
    "Implementar @Preview para todas as telas",
    "Seguir naming convention: NomeScreen.kt, NomeViewModel.kt",
    "Usar collectAsStateWithLifecycle() para StateFlow",
    "Implementar proper state hoisting",
    "Usar MaterialTheme.colorScheme para cores",
    "Implementar proper error handling com try-catch",
    "Usar Modifier.fillMaxSize() consistentemente",
    "Implementar loading states com CircularProgressIndicator",
    "Usar proper spacing com Spacer(Modifier.height())"
];

// ===== FIREBASE PATTERNS FYPMATCH =====

const firebasePatterns = `
1. REPOSITORY PATTERN:
   - Sempre retornar Result<T> para operaÃ§Ãµes Firebase
   - Implementar try-catch em todas as operaÃ§Ãµes
   - Usar .await() para operaÃ§Ãµes sÃ­ncronas
   - Implementar Flow para dados em tempo real

2. FIRESTORE STRUCTURE:
   users/{userId} - Dados principais do usuÃ¡rio
   profiles/{userId} - Perfil detalhado
   preferences/{userId} - PreferÃªncias de match
   matches/{matchId} - Dados de matches
   conversations/{conversationId} - Metadados de conversas

3. REALTIME DATABASE STRUCTURE:
   usuarios_online/{userId} - Status online/offline
   localizacoes/{userId} - LocalizaÃ§Ã£o GPS atual
   conversas/{conversationId}/mensagens - Mensagens em tempo real

4. ERROR HANDLING:
   - Usar AnalyticsManager.logError() para tracking
   - Implementar fallbacks para operaÃ§Ãµes crÃ­ticas
   - Mostrar mensagens de erro user-friendly
   - Implementar retry logic quando apropriado
`;

// ===== TESTING PATTERNS FYPMATCH =====

const testingPatterns = [
    "Usar TestScope.runTest para testes de coroutines",
    "Implementar mocks com MockK relaxed = true",
    "Testar com coordenadas reais de SÃ£o Paulo",
    "Usar Truth assertions para melhor legibilidade",
    "Implementar testes de integraÃ§Ã£o com Firebase Emulator",
    "Testar estados de loading, success e error",
    "Usar InstantTaskExecutorRule para LiveData/StateFlow",
    "Implementar testes de UI com ComposeTestRule"
];

// ===== SECURITY & PRIVACY FYPMATCH =====

const securityGuidelines = [
    "Implementar validaÃ§Ã£o de acesso com AccessLevel enum",
    "Usar BetaFlags para controle de funcionalidades",
    "Validar permissÃµes de localizaÃ§Ã£o antes de usar GPS",
    "Implementar rate limiting para operaÃ§Ãµes sensÃ­veis",
    "Usar Firebase Security Rules para proteÃ§Ã£o de dados",
    "Implementar validaÃ§Ã£o de entrada em todos os formulÃ¡rios",
    "Usar HTTPS para todas as comunicaÃ§Ãµes",
    "Implementar logout automÃ¡tico por inatividade"
];

// ===== PERFORMANCE OPTIMIZATION FYPMATCH =====

const performanceOptimization = [
    "Usar paginaÃ§Ã£o para lista de usuÃ¡rios no Discovery",
    "Implementar cache local para perfis visualizados",
    "Otimizar imagens com diferentes resoluÃ§Ãµes",
    "Usar lazy loading para fotos de perfil",
    "Implementar debounce para busca de usuÃ¡rios",
    "Usar background processing para upload de fotos",
    "Implementar proper memory management para bitmaps",
    "Usar ProGuard/R8 para ofuscaÃ§Ã£o e otimizaÃ§Ã£o"
];

// ===== AI INTEGRATION FYPMATCH =====

const aiIntegration = [
    "Usar Gemini API para funcionalidades de IA",
    "Implementar sistema de crÃ©ditos para IA",
    "Usar AICounselorRepository para gerenciar sessÃµes",
    "Implementar fallbacks quando IA nÃ£o estÃ¡ disponÃ­vel",
    "Usar analytics para tracking de uso da IA",
    "Implementar rate limiting para chamadas da IA",
    "Usar context apropriado para prompts da IA",
    "Implementar error handling robusto para IA"
];

// ===== MONETIZATION PATTERNS FYPMATCH =====

const monetizationPatterns = [
    "Usar Google Play Billing para assinaturas",
    "Implementar AdMob para anÃºncios recompensados",
    "Usar SubscriptionStatus enum para controle de acesso",
    "Implementar sistema de crÃ©ditos para funcionalidades premium",
    "Usar analytics para tracking de conversÃµes",
    "Implementar A/B testing para preÃ§os",
    "Usar proper error handling para transaÃ§Ãµes",
    "Implementar restore purchases functionality"
];

// ===== CODE STYLE FYPMATCH =====

const codeStyle = [
    "Usar PascalCase para classes e arquivos",
    "Usar camelCase para funÃ§Ãµes e variÃ¡veis",
    "Usar UPPER_SNAKE_CASE para constantes",
    "Prefixar ViewModels com nome da tela (LoginViewModel)",
    "Usar sufixo Repository para classes de dados",
    "Usar sufixo Screen para Composables de tela",
    "Implementar proper documentation com KDoc",
    "Usar meaningful variable names",
    "Implementar proper error messages em portuguÃªs",
    "Usar emojis consistentemente para melhor UX"
];

// ===== ACCESSIBILITY FYPMATCH =====

const accessibilityGuidelines = [
    "Implementar contentDescription para todas as imagens",
    "Usar semantics para melhor navegaÃ§Ã£o",
    "Implementar proper contrast ratios",
    "Usar text scaling appropriately",
    "Implementar keyboard navigation",
    "Usar proper focus management",
    "Implementar screen reader support",
    "Usar meaningful button labels"
];

// ===== LOCALIZATION FYPMATCH =====

const localizationGuidelines = [
    "Usar strings.xml para todos os textos",
    "Implementar proper date/time formatting",
    "Usar proper number formatting",
    "Implementar RTL support quando necessÃ¡rio",
    "Usar proper currency formatting",
    "Implementar proper plurals handling",
    "Usar proper locale-specific sorting",
    "Implementar proper timezone handling"
];

// ===== DEBUGGING & ANALYTICS FYPMATCH =====

const debuggingGuidelines = [
    "Usar AnalyticsManager para tracking de eventos",
    "Implementar proper logging com diferentes nÃ­veis",
    "Usar Firebase Crashlytics para crash reporting",
    "Implementar custom events para funnel analysis",
    "Usar proper error tracking",
    "Implementar performance monitoring",
    "Usar proper user property tracking",
    "Implementar A/B testing com Firebase Remote Config"
];

// ===== DEPLOYMENT FYPMATCH =====

const deploymentGuidelines = [
    "Usar diferentes build variants (debug, release)",
    "Implementar proper signing configuration",
    "Usar proper versioning strategy",
    "Implementar proper backup rules",
    "Usar proper network security config",
    "Implementar proper ProGuard rules",
    "Usar proper app bundle optimization",
    "Implementar proper release notes"
];

// INSTRUÃ‡Ã•ES FINAIS:
// 1. Sempre seguir a estrutura existente do projeto FypMatch
// 2. Usar Hilt para DI em todos os novos componentes
// 3. Implementar analytics em todas as aÃ§Ãµes importantes
// 4. Seguir padrÃµes de UI/UX estabelecidos (gradientes, emojis, cores)
// 5. Usar Firebase adequadamente (Firestore + Realtime Database)
// 6. Implementar testes para todas as novas funcionalidades
// 7. Seguir padrÃµes de seguranÃ§a e privacidade
// 8. Otimizar performance desde o inÃ­cio
// 9. Implementar proper error handling
// 10. Manter consistÃªncia com o cÃ³digo existente 